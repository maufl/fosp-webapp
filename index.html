<!DOCTYPE html>
<html>
<head>
<link rel='stylesheet' href='/css/bootstrap.css'></link>
<link rel='stylesheet' href='/css/jquery.mCustomScrollbar.css'></link>
<link rel='stylesheet' href='/css/main.css'></link>
<script type='text/javascript' src='/js/require.js' data-main='/js/app'></script>
<script type='text/html' id='acl-button'>
  <span class='glyphicon glyphicon-lock' data-bind='popover: { title: "Access control", template: "acl-popover-content" }'></span>
</script>
<script type='text/html' id='acl-popover-content'>
  <!-- ko if: acl -->
    <dl data-bind='foreach: acl.all' class='acl-list'>
      <dt><span data-bind="text: user"></span><button type="button" data-bind="click: $parent.acl.remove.bind($parent.acl)" class="close pull-right" aria-hidden="true">&times;</button></dt>
      <dd>
        <table>
          <tr>
            <th>Content</th>
            <td>read <input type='checkbox' data-bind='3-state-checkbox: { states: ["yes", "no", "inherit"], target: dataRead }' /></td>
            <td>write <input type='checkbox' data-bind='3-state-checkbox: { states: ["yes", "no", "inherit"], target: dataWrite }' /></td>
          </tr>
          <tr>
            <th>Access control</th>
            <td>read <input type='checkbox' data-bind='3-state-checkbox: { states: ["yes", "no", "inherit"], target: aclRead }' /></td>
            <td>write <input type='checkbox' data-bind='3-state-checkbox: { states: ["yes", "no", "inherit"], target: aclWrite }' /></td>
          </tr>
          <tr>
            <th>Subscriptions</th>
            <td>read <input type='checkbox' data-bind='3-state-checkbox: { states: ["yes", "no", "inherit"], target: subscriptionsRead }' /></td>
            <td>write <input type='checkbox' data-bind='3-state-checkbox: { states: ["yes", "no", "inherit"], target: subscriptionsWrite }' /></td>
          </tr>
        </table>
      </dd>
    </dl>
    <form class="form-inline" role="form">
      <div class="form-group">
        <input type='email' class='form-control input-sm' data-bind='value: acl.newUser'>
      </div>
      <input type='submit' class='btn btn-default btn-sm' data-bind='click: acl.add.bind(acl)' value="Add">
    </form>
  <!-- /ko -->
</script>
<script type='text/html' id='subscriptions-button'>
  <span class='glyphicon glyphicon-bell' data-bind='popover: { title: "Subscriptions", template: "subscriptions-popover-content" }'></span>
</script>
<script type='text/html' id='subscriptions-popover-content'>
<!-- ko if: subscriptions -->
  <dl class='subscriptions-list' data-bind='foreach: subscriptions.all'>
    <dt><span data-bind='text: user'></span><button type="button" data-bind="click: $parent.subscriptions.remove.bind($parent.subscriptions)" class="close pull-right" aria-hidden="true">&times;</button></dt>
    <dd>
      <form class='form-inline'>
        <div class='form-group'>
          <label>created <input type='checkbox' name='created' data-bind='checked: created' /></label>
        </div>
        <div class='form-group'>
          <label>updated <input type='checkbox' name='updated' data-bind='checked: updated' /></label>
        </div>
        <div class='form-group'>
          <label>deleted <input type='checkbox' name='deleted' data-bind='checked: deleted' /></label>
        </div>
        <br />
        <div class='form-group'>
          <label>depth</label>
          <input type='number' min='-1' class='form-control input-sm' data-bind='value: depth' />
        </div>
      </form>
    </dd>
  </dl>
  <form class="form-inline" role="form">
    <div class="form-group">
      <input type='email' class='form-control input-sm' data-bind='value: subscriptions.newUser'>
    </div>
    <input type='submit' class='btn btn-default btn-sm' data-bind='click: subscriptions.add.bind(subscriptions)' value="Add">
  </form>
<!-- /ko -->
</script>
<script type='text/html' id='fosp-object-list'>
  <div class='node-list flx-v scroll-y flx-nostrech' data-bind='with: children'>
    <!-- ko foreach: all -->
      <div class='node flx-nostrech' data-bind='click: $parent.select.bind($parent), css: { selected: $parent.selectedNode() === $data }'>
        <div class='node-head' data-bind='on: { emitter: $data, event: "updated", pulse: { backgroundColor: "#b7dbd1" } }'>
          <small data-bind='text: owner'></small>
          <span class='edit-options pull-right'>
            <!-- ko template: 'acl-button' -->
            <!-- /ko -->
            <!-- ko template: 'subscriptions-button' -->
            <!-- /ko -->
            <span class='glyphicon glyphicon-pencil' data-bind='click: startEdit'></span>
            <span class='glyphicon glyphicon-trash' data-bind='click: trash'></span>
          </span>
          <br />
          <span class='time'>created <span data-bind='prettyTime: btime'></span></span>
          <span class='time' data-bind='visible: isModified'>:: modified <span data-bind='prettyTime: mtime'></span></span>
        </div>
        <div class='node-body'>
          <span data-bind='visible: ! editing(), text: bodyString'></span>
          <textarea data-bind='visible: editing, value: editingContent'></textarea>
          <div class='btn-group pull-right' data-bind='visible: editing'>
            <button type='button' class='btn btn-default btn-xs' data-bind='click: cancleEdit'><span class='glyphicon glyphicon-remove-sign'></span></button>
            <button type='button' class='btn btn-default btn-xs' data-bind='click: commitEdit'><span class='glyphicon glyphicon-ok-sign'></span></button>
          </div>
          <span class='clearfix'></span>
        </div>
      </div>
    <!-- /ko -->
    <div class='node flx-nostrech'>
      <div class='node-head'>
        <small>Add content</small>
        <button type='button' class='btn btn-default btn-xs pull-right' data-bind='click: addNode'><span class='glyphicon glyphicon-floppy-disk'></span></button>
      </div>
      <div class='node-body'>
        <textarea data-bind='value: newNodeContent'></textarea>
      </div>
    </div>
  </div>
  <!-- ko template: { name: "fosp-object-list", data: children.selectedNode, if: children.selectedNode } -->
  <!-- /ko -->
</script>
</head>
<body>
<div id='explorer-container' class='page'>
  <div class="inset-rounded flx-h">
    <div id='side-bar' class=''>
      <div class='title'>
        <h2><span class="glyphicon glyphicon-globe"></span>&nbsp;fosp</h2>
      </div>
      <ul class="nav-list">
        <li class="nav-label">Home</li>
        <li><a href="#">Profile</a></li>
        <li><a href="#">Messages</a></li>
      </ul>
      <ul class='nav-list nav-list-vertical pull-down'>
        <li><a class='glyphicon glyphicon-log-out' data-bind='click: logout'></a></li>
      </ul>
    </div>
    <div id='explorer' data-bind='with: currentRoot' class='flx-strech flx-v'>
      <div id='explorer-head'>
        <span>Now on:</span>
        <h3 data-bind='text: path'></h2>
        <!-- ko template: 'acl-button' --><!-- /ko -->
        <!-- ko template: 'subscriptions-button' --><!-- /ko -->
      </div>
      <div id='explorer-body' class='flx-strech flx-h scroll-x' data-bind='template: { name: "fosp-object-list", data: $data }'>
      </div>
    </div>
  </div>
</div>
<div id='login-container' class='page moving' data-bind='with: login, css: { rolledup: login.authenticated }' >
  <div class='container' id='login-form-container'>
    <span class='glyphicon glyphicon-globe' id='login-logo'></span>
    <div class='alert alert-danger' style='display: none' data-bind='visible: registrationFailure, text: registrationFailure'></div>
    <div class='alert alert-danger' style='display: none' data-bind='visible: authenticationFailure, text: authenticationFailure'></div>
    <form class="form" role="form">
      <div class="form-group" data-bind="css: { 'has-warn' : $parent.connectFailed, 'has-error': authenticationFailure }">
        <label for="inputID" class="control-label">Full username</label>
        <input data-bind='value: user' type="email" class="form-control" id="inputID" placeholder="alice@wonderland.lit">
      </div>
      <div class="form-group" data-bind="css: { 'has-error' : authenticationFailure }">
        <label for="inputPassword" class="control-label">Password</label>
        <input data-bind='value: password' type="password" class="form-control" id="inputPassword" placeholder="Password">
      </div>
      <div class="form-group" data-bind='visible: signup, css: { "has-error": passwordsDiffer }'>
        <label for="inputPasswordConfirm" class="control-label">Password confirmation</label>
        <input data-bind='value: passwordConfirmation' type="password" class="form-control" id="inputPasswordConfirm" placeholder="Password">
      </div>
      <div class="checkbox">
        <label>
          <input type="checkbox" data-bind='checked: signup'>Create new account
        </label>
      </div>
      <div class="checkbox">
        <label>
          <input type="checkbox" data-bind='checked: autoLogin'>Automatically login
        </label>
      </div>
      <div class="form-group">
        <button type="submit" class="btn btn-primary pull-right" data-bind='text: signup() ? "Sign up" : "Sign in", click: $parent.connect.bind($parent)'></button>
      </div>
    </form>
  </div>
</div>
</body>
</html>
